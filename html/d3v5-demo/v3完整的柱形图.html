<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <style>
    .axis path,
    .axis line{
      fill: none;
      stroke: black;
      shape-rendering: crispEdges;
    }

    .axis text {
      font-family: sans-serif;
      font-size: 11px;
    }

    .number {
      fill: #000;
      text-anchor: middle;
    }

  </style>
</head>
<body>
  注：此图基于d3-v3版本
</body>
</html>
<script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
<script>
let width = 800,
    height = 500,
    padding = 20 // 画布四周的空白大小
//添加svg画布
let svg = d3.select('body')
            .append('svg')
            .attr('width', width)
            .attr('height', height)
            .style('background', '#ccc')

//定义一个数组
let dataset = [10, 20, 30, 40, 33, 24, 12, 5]
//x轴比例尺(序数)
let xScale = d3.scale.ordinal()
               .domain(d3.range(dataset.length))
               .rangeRoundBands([0, width - 2 * padding])
//y轴比例尺(线性)
let yScale = d3.scale.linear()
               .domain([0, d3.max(dataset)])
               .range([height - 2 * padding, 0])
//坐标轴
let xAxis = d3.svg.axis()
              .scale(xScale)
              .orient('bottom')
let yAxis = d3.svg.axis()
              .scale(yScale)
              .orient('left')
//矩形之间的间距
let space = 10
//添加矩形元素
let rect = svg.selectAll('rect')
              .data(dataset)
              .enter()
              .append('rect')
              .attr('transform', 'translate(' + 2 * padding + "," + padding/2 + ')')
              .attr('x', function (d, i) {
                return xScale(i) + space / 2
              })
              .attr('y', function (d, i) {
                return yScale(d)
              })
              .attr('width', xScale.rangeBand() - space)
              .attr('height', function (d, i) {
                return height - 2 * padding - yScale(d)
              })
              .style('fill', function () {
                return "hsl(" + Math.random() * 360 + ",100%,50%)"
              })
//添加文字元素
let text = svg.selectAll('.number')
              .data(dataset)
              .enter()
              .append('text')
              .attr('class', 'number')
              .attr('transform', 'translate(' + 2 * padding + "," + padding/2 + ')')
              .attr("x", function(d,i){
                  return xScale(i) + space / 2
              })
              .attr("y",function(d){
                  return yScale(d)
              })
              .attr("dx",function(d,i){
                  return (xScale.rangeBand() - space) / 2
              })
              .attr("dy",function(d){
                  return 20
              })
              .text(function(d){
                  return d
              });
//svg中添加x坐标
svg.append('g')
   .attr('class', 'axis')
   .attr("transform","translate(" + padding*3/2 + "," + (height - padding*3/2) + ")")
   .call(xAxis)

//svg添加y轴
svg.append("g")
  .attr("class","axis")
  .attr("transform","translate(" + padding*3/2 + "," + padding/2 + ")")
  .call(yAxis)
</script>