# 常用代码块

```js
// 加载
v-loading="loading" element-loading-text="加载中..."
v-loading="loading" :element-loading-text="loadingText"

// 弹窗提示（单个操作和批量操作）
this.$notify({offset: 60, type: 'warning', message: '时长只能输入数字' });
this.$notify({offset: 60, type: 'error', message: res.msg });
if(this.multipleSelection.length === 0) {
    this.$notify({offset: 60, type: 'error', message: '请至少选择一条报警记录' });
} else {
    this.$confirm(`确定要删除吗?`, '提示', {confirmButtonText: '确定', cancelButtonText: '取消', type: 'warning'})
        .then(() => {
            this.$https
                ._delete('/monitorAlarmRecord/delete', this.ids)
                .then(res => {
                if(res.code === 200) {
                    this.getData()
                    this.$notify({offset: 60, type: 'success', message: res.msg });
                } else {
                    this.$notify({offset: 60, type: 'error', message: res.msg });
                }
            })
    }).catch(() => { return })
}
//	分页
Object.assign(this.pagination, {total: res.result.total, pages: res.result.pages})
```



# 封装的组件

## 搜索框

```vue
<Search 
	placeholder="文件名" 
	@getSearchValue="((val)=>{target=val})" 
	@search="((val)=>{target=val;currentPage=1;getData()})" 
></Search>

```

## 下拉选择框

```vue
<Select
	:defaultValue="defaultValue"
	:options="$constant['ALARM_RS']" 
	@handleSelect="((val) => {defaultValue=val;currentPage=1;getData()})"
></Select>
```

## 时间选择器

```vue
<DateTimePicker 
	type="date" 
    :defaultTime="defaultTime" 
	@changeDate="((val) => {defaultTime = value;getData()})"
></DateTimePicker>
```

## 分页

```vue
<Pagination 
	:currentPage="currentPage" 
	:pagination="pagination" 
	@changeCurrentPage="((page) => {currentPage=page;getData()})"
></Pagination>
```



# 封装的方法

## 数据类型

```js
// target: 目标值， datatype: 预期的类型
const _toString = Object.prototype.toString;

export const getDataType = (target, datatype) => {

  let type = _toString.call(target).slice(8, -1);

  return Object.is(type, datatype);

};
```

## 获取常量

```js
// 获取缓存数据 constant:常量， target：要匹配的目标值
export const getCache = (constant, target) => {
	// 目标值没有赋值或空或undefiend
	if (!target) return "--";
	let arr = CONSTANT[constant].filter(v => v.value === target);
	return (arr && Object.keys(arr).length !== 0) ? arr[0] : "--"
};
// 返回值 [{value: '', label: '', class: '',...}]
```



## 浏览器复制功能

原理：把要复制的目标值 赋值 给临时创建的input元素，使用doocument的复制命令来实现复制功能

```js
export const copy = value => {
  let ipt = document.createElement("input");
  ipt.value = value;
  document.body.appendChild(ipt);
  ipt.select(); // 选择input对象
  document.execCommand("Copy"); // 执行浏览器复制命令
  ipt.style.display = "none";
};
```

## 时间格式化

```js
export const timeFormat = (timeStamp, flag) => {
  let year = new Date(timeStamp).getFullYear();
  let month =
    new Date(timeStamp).getMonth() + 1 < 10
      ? "0" + (new Date(timeStamp).getMonth() + 1)
      : new Date(timeStamp).getMonth() + 1;
  let day =
    new Date(timeStamp).getDate() < 10
      ? "0" + new Date(timeStamp).getDate()
      : new Date(timeStamp).getDate();
  let hours =
    new Date(timeStamp).getHours() < 10
      ? "0" + new Date(timeStamp).getHours()
      : new Date(timeStamp).getHours();
  let minutes =
    new Date(timeStamp).getMinutes() < 10
      ? "0" + new Date(timeStamp).getMinutes()
      : new Date(timeStamp).getMinutes();
  let seconds =
    new Date(timeStamp).getSeconds() < 10
      ? "0" + new Date(timeStamp).getSeconds()
      : new Date(timeStamp).getSeconds();

    switch (flag) {
        case 1:
            return `${year}${month}${day}${hours}${minutes}${seconds}`; //  YYMMDDHHMMSS
        case 2:
            return `${year}-${month}-${day}`; //  YY-MM-DD
        case 3:
            return `${month}-${day}`; //  MM-DD
        default:
            return `${year}-${month}-${day} ${hours}:${minutes}:${seconds}`; //  YY-MM-DD HH:MM:SS
    }
};
```



# vue

## 自定义方法传参

主要是针对该方法有默认参数的情况下进行传参（正常传参默认会覆盖默认参数，所以通过闭包来实现自定义传参）

==注：参数必须用括号括起来，尽管参数只有一个，也要用括号，否则闭包无效==

```js
@change="((val)=>{change(val, key)})"	
```

## 使用通过script引入的库

```js
// html
<script type="text/javascript" src="<%= BASE_URL %>js/aes.js"></script>
<script type="text/javascript" src="<%= BASE_URL %>js/rsa.js"></script>
// vue.config.js
configureWebpack: {
    externals: {
      JSEncrypt: "JSEncrypt",
      CryptoJS: "CryptoJS"
    }
  },
// 使用
import JSEncrypt from "JSEncrypt";
import CryptoJS from "CryptoJS";
```









# encrypt

原理：通过AES（对称）和RSA（非对称）加密解密

## AES

## RSA

## 请求方式及参数类型的判断

### GET

params：Object

加密前：Object

加密后：Object

### POST/PUT

+ data：Array

  加密前：（设置类型必须写在加密前，否则无效）

  + 如果不设置："Content-type": "application/json; charset=utf-8"，参数类型会转为FormData类型（后端为params接收）
  + 如果设置："Content-type": "application/json; charset=utf-8"，（后端为body接收）
  + params=JSON.stringify(params)

  加密后：String

+ data：FormData（主要是针对文件上传）

  加密前：需要对formData对象进行遍历加密，否则会对FormData对象加密

  加密后：需要重新添加到formData对象中，否则加密后的数据类型不是formData类型

  ```js
  let formData = new FormData();
  for (var item of data.entries()) {
      if (getDataType(item[1], "File")) {  //  对文件对象不进行加密
      	formData.append(item[0], value);
      } else {
      	formData.append(item[0], item[1]);
      }
  }
  ```

+ data: Object

  加密前：.遍历对象，只对value加密

  加密后：Object

  

  | value数据类型  |                           注意事项                           |
  | :------------: | :----------------------------------------------------------: |
  | 空字符串（""） |   如果没有默认值或不是必传参数，可把默认值设为==空字符串==   |
  |    null对象    | 没有特殊情况，不要赋值为null对象，否则会被解密为"null",（基本不存在） |
  |   undefined    | 如果该字段不是必填项，后端没有默认值，前端没有赋值时，相当于此value=undefiend，所以要么赋值 ，要么不传此参数 |
  |  Array/Object  |                加密前：JSON.stringify(params)                |

### DELETE

+ params：参数在url上，后端通过params接收

+ data：
  + 默认json类型，同post一样（参数在body体内，后端通过body接收）
  + qs.stringify(params),设置`"Content-Type": "application/x-www-form-urlencoded;charset=UTF-8"`（参数在body体内，后端通过params接收）

# JS

+ sessionStorage.getItem("sessionId")：如果此值不存在，得到的是'undefiend'字符串，非undefiend